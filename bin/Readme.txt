
− BonTest Ver.1.40 −


１．概要
　　・BonシリーズのMPEG2-TS処理エンジン「BonTsEngine」を使用したサンプルプログラムです。
　　　スタンドアロンビューア凡(仮称)用エンジンの実証試験用コンテナです。
　　・チューナから直接番組を視聴することができます。
　　・TSファイルを再生することができます。
　　・このサンプルには下記処理コードが含まれています。

　　　- TSパケット
　　　- PSIセクション
　　　- PATテーブル
　　　- PMTテーブル
　　　- SDTテーブル
　　　- PESパケット
　　　- MPEG2-ES
　　　- ADTS(AAC)
　　　- Multi2暗号
　　　- B-CASカード制御
　　　- DirectShow
　　　- AACデコード
　　　- ARIB STD-B24文字コード

　　・下記ページにて全体の構成や各クラスの解説を行ってゆく予定です。

　　　http://2sen.dip.jp/cgi-bin/bondiary/nicky.cgi

　　※本ソフトウェアの動作には「Microsoft Visual C++ 2005 SP1 再頒布可能パッケージ」が必要です。
　　　　http://www.microsoft.com/downloads/details.aspx?displaylang=ja&FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647


２．注意事項
　　・B-CASカードを許可された機器以外で使用することはB-CASカードの契約約款に抵触する可能性がある
　　　ため、本ソフトウェアは自己の責任において使用して下さい。
　　・本ソフトウェアは下記「公開規格」の技術情報に基づき「正規の手法」を用いるよう実装されています。
　　　純粋に技術的な検証を目的としたサンプルプログラムであり、第三者の知的財産権を侵害する可能性の
　　　ある目的に使用されることを作者は一切意図しておらず、またこれらの行為を禁止します。
　　・本ソフトウェアは正規にライセンスされたB-CASカードを用いることにより復号を行います。
　　・本ソフトウェア単体ではいかなる著作物の技術的保護手段も回避することはできません。
　　・本ソフトウェアは「フリーソフト」です。
　　・本ソフトウェアはARIB規格に適合することを保障しておらず、いかなる種別の製品にも該当しません。
　　・本ソフトウェアを使用した結果発生したいかなる損害も作者は責任を負うことはできません。
　　・本サンプルプログラムのソースコードの取り扱いはGPLに従うこととします。

　　これらに同意頂ける場合にのみ、本ソフトウェアの使用を許可致します。


３．ライセンスについて
　　・本パッケージに含まれる全てのソースコード、バイナリについて著作権は一切主張しません。
　　・オリジナルのまま又は改変し、各自のソフトウェアに自由に添付、組み込むことができます。
　　・但しGPLに従うことを要求しますのでこれらを行う場合はソースコードの開示が必須となります。
　　・このとき本ソフトウェアの著作権表示を行うかどうかは任意です。
　　・本ソフトウェアはFAAD2のライブラリ版バイナリを使用しています。

　　　"Code from FAAD2 is copyright (c) Nero AG, www.nero.com"

　　・ビルドに必要な環境
　　　- Microsoft Visual Studio 2005 以上　※MFCが必要
　　　- Microsoft Windows SDK v6.0 以上　　※DirectShow基底クラスのコンパイル済みライブラリが必要
　　　- Microsoft DirectX 9.0 SDK 以上


４．参考文献
　　・ARIB STD-B10
　　・ARIB STD-B24
　　・ARIB STD-B25
　　・ARIB STD-B32
　　・ISO/IEC 11172-3
　　・ISO/IEC 13818-1
　　・ISO/IEC 13818-2
　　・ISO/IEC 13818-7

　　・まるも製作所「ARIB STD-B25 仕様確認テストプログラム」
　　・Meru氏「BonTsEngine改造版」
　　・Meru氏「CapUSB M-Edition」
　　・作者不明「Mpeg2-TSのストリームからデータ放送情報を抽出するテスト」
　　・Microsoft DirectX 9.0「PSI パーサー フィルタ サンプル」


５．サポート、連絡先
　　　連絡先　　：　拡張ツール中の人　　nakanohito@2sen.dip.jp
　　　公式サイト：　http://2sen.dip.jp/friio/

６．更新履歴
　Ver.1.40 ・TSファイル再生機能を実験的に実装した。(デコーダグラフの排他制御が未実装なため機能が非常に制限される)
　　　　　 ・イベントハンドラにコールバック関数を使用していた箇所を可能な限りインタフェース実装方式にした。
　　　　　 ・メモリリークを修正。
　　　　　 ・BonTsEngine微調整。

　Ver.1.32 ・PMTのDescriptors Fieldに複数のDescriptorが含まれている場合に復号できなかった不具合修正。
　　　　　　 →Descriptors Fieldを抽象化したクラスを追加しこれに伴うインタフェースの変更も行った。
　　　　　 ・CTsPacketParserのデフォルトでNULLパケットを出力しないようにした。(出力設定も可能)

　Ver.1.31 ・ファイルへの録画機能追加。
　　　　　 ・デバッグ用情報表示追加。
　　　　　 ・BSで視聴できない放送局があった不具合を修正。
　　　　　　 →放送局によってはPATに含まれる全サービスのPMTを送出していない場合がある。

　Ver.1.30 ・サービス切替に対応。
　　　　　 ・BonTsEngine更新
　　　　　　　- CMediaDecoder派生クラス間で転送されるCMediaDataを動的に生成しないようにした。
　　　　　　　　→メモリ確保/開放のオーバーヘッドが無くなったためパフォーマンスが向上。
　　　　　　　- スクランブル解除できなかったパケットも出力するようにした。(Meru氏の指摘反映)
　　　　　　　- ECM処理に失敗した場合は1度だけB-CASカードの初期化を試行するようにした。(Meru氏の指摘反映)
　　　　　　　- SDT処理クラスを新規作成。(CSdtTable、CServiceDesc)
　　　　　　　- ARIB STD-B24文字コード処理クラス新規作成。(CAribString)
　　　　　　　- その他バグフィックス、調整多数

　Ver.1.20 ・BonTsEngine更新
　　　　　　　- PIDマップ管理/ターゲットクラス追加、及びこれら派生クラスの変更。
　　　　　　　- CPsiSingleTableクラス追加。
　　　　　　　- 上記によりCTsDescramblerの構成を根本的に見直し。
　　　　　　　　→途中でネットワーク変更を含むようなストリームが入力されても正常に復号できるようになった。
　　　　　　　- その他微調整。
　　　　　 ・CAacDecoder改良。
　　　　　　　- モノラル/ステレオの切り替わり後、音声がデコードされなくなる不具合を修正。
　　　　　 ・SSE2の代わりにSSEを使用するようにした。

　Ver.1.12 ・初回リリース
